<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Zeronpa</title>

        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0" />

        <style>
            .touchy {
                cursor: pointer;
            }

            html {
                height: 100%;
                width: 100%;
            }

            body {
                height: 100%;
                width: 100%;
                margin: 0;
                overflow: hidden;

                background-color: gray;
                color: white;
                font-family: Helvetica, Arial, sans-serif;
            }




            /* Slider */

            @keyframes kk_slidin {
                0%   {left: 100%;}
                100% {left: 50%;}
            }

            #zack_slider {
                border: 1px solid;
                border-color: #333 yellow #333 #333;
                background-color: yellow;
                color: black;

                box-sizing: border-box;
                height: 100%;
                min-height: 125px; /* Pour éviter que le dépasseur ne se déforme lors du changement. */
                padding: 5px;
                margin: 0;

                position: absolute;
                top: 0;
                z-index: 2;
            }

            .slider_base {
                left: 100%;
                width: 50%;
            }

            .sliderHidden {
                left: 100%;
                width: 50%;
                animation-name: kk_slidin;
                animation-duration: .8s;
                animation-timing-function: ease-in;
                animation-direction: reverse;
            }

            .sliderVisible {
                left: 50%;
                width: 50%;
                animation-name: kk_slidin;
                animation-duration: .8s;
                animation-timing-function: ease-out;
            }

            .depasseur {
                border: solid 1px;
                border-color: #333 yellow #333 #333;
                border-radius: 1px 0 0 1px;
                background-color: inherit;
                cursor: pointer;

                padding: 5px 2px;
                font-weight: bold;

                position: absolute;
                z-index: 2;
                right: 100%;
                top: 0;
            }

            .prevent-select {
                -webkit-user-select: none; /* Safari */
                -ms-user-select: none; /* IE 10 and IE 11 */
                user-select: none; /* Standard syntax */
            }

            /* Slider */

            @keyframes doNotVibe {
                0%   {opacity: 0.5; visibility: visible;}
                100% {opacity: 0;   visibility: hidden; }
            }

            .grayFilter {
                width: 100%;
                height: 100%;

                z-index: 1;
                position: absolute;
                top: 0;
                left: 0;
            }

            .filterBase {
                visibility: hidden;
                opacity: 0;
                background-color: black;
            }

            .filterVisible {
                opacity: 0.5;
                background-color: black;
                animation-name: doNotVibe;
                animation-duration: .8s;
                animation-direction: reverse;
            }

            .filterHidden {
                visibility: hidden;
                background-color: black;
                animation-name: doNotVibe;
                animation-duration: .8s;
            }

            @media only screen and (max-width: 1025px) {
                .slider_base {
                    width: 0px;
                    right: 0;
                    left: auto;
                    padding: 0;
                    visibility: hidden;
                }

                .sliderHidden {
                    width: 0px;
                    right: 0;
                    left: auto;
                    padding: 0;
                    visibility: hidden;
                    animation-name: none;
                }

                .sliderVisible {
                    width: 80%;
                    left: 20%;
                    animation-name: none;
                }

                .depasseur {
                    visibility: visible;
                    padding: 30px;
                }

                /* Slider */

                .filterVisible {
                    animation-name: none;
                }

                .filterHidden {
                    animation-name: none;
                }
            }







            #mainMain {
                height: 100%;
                width: 100%;
                overflow: hidden;
            }

            #mainSection {
                text-align: center;
                width: 100%;
                height: 100%;
                overflow-y: scroll;
            }

            #musicInfo {
                color: yellow;
                font-size: 12px;
                width: 70%;
                margin: auto;
            }

            .soundControl {
                text-align: right;
            }

            .decor {
                width: 100%;
                text-align: center;
                margin-top: 30px;
                margin-bottom: 20px;
            }

            .decor img {
                height: 200px;
            }

            table.content {
                text-align: left;
                border: 1px solid black;
                border-collapse: collapse;
                margin: auto;
                margin-top: 30px;
                margin-bottom: 20px;
                width: 75%;
            }

            td {
                border: 1px solid black;
                padding: 10px;
            }

            td.portrait {
                background-color: #474747;
                text-align: center;
                vertical-align: middle;
                width: 110px;
            }

            td.portrait img {
                width: 100px;
                height: 100px;
            }

            td.portrait p {
                font-weight: bold;
                margin-top: 5px;
                margin-bottom: 0;
                height: 20px;
            }
        </style>
    </head>
    <body id="body">
        <div id="mainMain">
            <div id="zack_slider" class="slider_base">
                <div class="depasseur prevent-select" onclick="slide();"><span class="material-symbols-outlined">dehaze</span></div>
                <div class="soundControl">
                    <button id="pauseButton" onclick="pause()" class="touchy"><span class="material-symbols-outlined">play_arrow</span></button>
                    <span style="color: black;" id="muteButton" onclick="mute();" class="material-symbols-outlined touchy">volume_up</span>
                    <input id="volumeBar" type="range" min="0" max="100" value="50">
                    <audio id="musicPlayer" loop="yes" src="musics/4_33.mp3"></audio>
                    <p id="trackInfo">Current track : none</p>
                </div>
            </div>
            <div id="grayFilter" className="grayFilter filterBase" onclick="slide();"></div>

            <div id="mainSection">
                <p id="musicInfo">
                    This story is accompanied by music, that plays and changes as you scroll the page.
                    You can adjust and disable it inside the sliding menu on the top-right corner of the screen.
                </p>
            </div>
        </div>

        <script src="libs/papaparse.min.js"></script>
        <script src="display.js"></script>
        <script>
            pause();


            function slide() {
                let zack = document.getElementById("zack_slider");
                let phil = document.getElementById("grayFilter");

                if (zack.className.includes("sliderVisible")) {
                    zack.classList.remove("sliderVisible");
                    phil.classList.remove("filterVisible");

                    void zack.offsetWidth; // Provoque un recalcul pour réinitialiser l'animation
                    void phil.offsetWidth;

                    zack.className =            "sliderHidden";
                    phil.className = "grayFilter filterHidden";
                } else {
                    // Forcer la réinitialisation de l'animation
                    zack.classList.remove("sliderHidden");
                    phil.classList.remove("filterHidden");

                    void zack.offsetWidth; // Provoque un recalcul pour réinitialiser l'animation
                    void phil.offsetWidth;

                    zack.className =            "sliderVisible";
                    phil.className = "grayFilter filterVisible";
                }
            }

            readScript("test");
        </script>
    </body>
</html>
